<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>分分钟入门mongodb | RobinTec</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="在大数据市场中，传统的关系型数据库呈现出来的性能劣势日益明显，而非关系型数据库的应用反而逐渐受到青睐。作为一名即将从事运维工作并立志做架构师的数据库爱好者来说，MongoDB成为了我学习的一大焦点。MongoDB是一种可以提供高性能、高可用以及自动比例缩放的开源非关系型文档数据库，属于NoSQL的一种。下文就我通过最近对MongoDB的学习做一个简单的总结。">
<meta property="og:type" content="article">
<meta property="og:title" content="分分钟入门mongodb">
<meta property="og:url" content="http://huxiaobo.net/2014/09/20/分分钟入门mongodb/index.html">
<meta property="og:site_name" content="RobinTec">
<meta property="og:description" content="在大数据市场中，传统的关系型数据库呈现出来的性能劣势日益明显，而非关系型数据库的应用反而逐渐受到青睐。作为一名即将从事运维工作并立志做架构师的数据库爱好者来说，MongoDB成为了我学习的一大焦点。MongoDB是一种可以提供高性能、高可用以及自动比例缩放的开源非关系型文档数据库，属于NoSQL的一种。下文就我通过最近对MongoDB的学习做一个简单的总结。">
<meta property="og:updated_time" content="2015-11-03T07:50:35.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="分分钟入门mongodb">
<meta name="twitter:description" content="在大数据市场中，传统的关系型数据库呈现出来的性能劣势日益明显，而非关系型数据库的应用反而逐渐受到青睐。作为一名即将从事运维工作并立志做架构师的数据库爱好者来说，MongoDB成为了我学习的一大焦点。MongoDB是一种可以提供高性能、高可用以及自动比例缩放的开源非关系型文档数据库，属于NoSQL的一种。下文就我通过最近对MongoDB的学习做一个简单的总结。">
  
    <link rel="alternative" href="/atom.xml" title="RobinTec" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/avatar.jpeg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Robin_Hu</a></h1>
		</hgroup>

		
		<p class="header-subtitle">你不是一个人在coding</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/RobinTec" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/lovehxb007" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
					        
								<a class="mail" target="_blank" href="/robin1993@gmail.com" title="mail">mail</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/HTTPS/" style="font-size: 10px;">HTTPS</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Linux入门/" style="font-size: 10px;">Linux入门</a> <a href="/tags/OpenStack/" style="font-size: 10px;">OpenStack</a> <a href="/tags/SSL-TLS/" style="font-size: 10px;">SSL/TLS</a> <a href="/tags/Ubuntu/" style="font-size: 10px;">Ubuntu</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/mapreduce/" style="font-size: 10px;">mapreduce</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/shell/" style="font-size: 10px;">shell</a> <a href="/tags/对称加密与非对称加密/" style="font-size: 10px;">对称加密与非对称加密</a> <a href="/tags/并行计算/" style="font-size: 10px;">并行计算</a> <a href="/tags/网络/" style="font-size: 10px;">网络</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">别问我是谁，请称呼我为“三流码农”</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Robin_Hu</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/avatar.jpeg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Robin_Hu</h1>
			</hgroup>
			
			<p class="header-subtitle">你不是一个人在coding</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/RobinTec" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/lovehxb007" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
			        
						<a class="mail" target="_blank" href="/robin1993@gmail.com" title="mail">mail</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-分分钟入门mongodb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/09/20/分分钟入门mongodb/" class="article-date">
  	<time datetime="2014-09-20T02:14:36.000Z" itemprop="datePublished">2014-09-20</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      分分钟入门mongodb
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/">mongodb</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在大数据市场中，传统的关系型数据库呈现出来的性能劣势日益明显，而非关系型数据库的应用反而逐渐受到青睐。作为一名即将从事运维工作并立志做架构师的数据库爱好者来说，MongoDB成为了我学习的一大焦点。<br>MongoDB是一种可以提供高性能、高可用以及自动比例缩放的开源非关系型文档数据库，属于NoSQL的一种。下文就我通过最近对MongoDB的学习做一个简单的总结。<br><a id="more"></a><br>在大数据市场中，传统的关系型数据库呈现出来的性能劣势日益明显，而非关系型数据库的应用反而逐渐受到青睐。作为一名即将从事运维工作并立志做架构师的数据库爱好者来说，MongoDB成为了我学习的一大焦点。<br>MongoDB是一种可以提供高性能、高可用以及自动比例缩放的开源非关系型文档数据库，属于NoSQL的一种。下文就我通过最近对MongoDB的学习做一个简单的总结。   </p>
<h4 id="一、安装并启动mongodb">一、安装并启动mongodb</h4><p>在开始之前，先介绍一下MongoDB在Linux下的安装，我的系统版本是RHEL6.4。<br>1.二进制包解压安装<br>官网下载二进制安装包，下载包这种基础操作我就不做赘述了，假定已经下好包到/tmp目录下了。<br>因为下载的是二进制包，所以解压就可以用了，通常我们将其解压到/usr/local/目录下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># tar xf mongodb-linux-x86_64-<span class="number">2.6</span><span class="number">.4</span>.tgz -C /usr/local/</span></span><br><span class="line"><span class="preprocessor"># ln -s /usr/local/mongodb-linux-x86_64 /usr/local/mongodb</span></span><br></pre></td></tr></table></figure></p>
<p>同样，还是为了方便，解压过后的目录中有个bin目录下存放于mongo操作相关的所有可执行命令，可以将mongo的bin目录加入环境变量<br><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">echo</span> "export <span class="built_in">PATH</span>=$<span class="built_in">PATH</span>:/usr/local/mongodb/bin" » /etc/profile</span><br></pre></td></tr></table></figure></p>
<p>创建数据存放目录，默认为/data/db，需要手动创建<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">mkdir</span> -pv /data/<span class="keyword">db</span></span><br></pre></td></tr></table></figure></p>
<p>为了在不重启的前提下使环境变量在当前终端生效，请执行如下命令重新加载/etc/profile文件：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">source</span> <span class="regexp">/etc/</span>profile</span><br></pre></td></tr></table></figure></p>
<p>启动mongod服务：<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># mongod —dbpath=/data/db —fork</span></span><br></pre></td></tr></table></figure></p>
<p>如果未将解压目录下的bin目录加入环境变量中，请输入绝对路径执行命令：<br><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># <span class="regexp">/usr/</span>local<span class="regexp">/mongodb/</span>bin<span class="regexp">/mongod —fork</span></span><br></pre></td></tr></table></figure></p>
<p><strong>【注意】</strong>解压安装启动mongod服务默认在前台运行，加上—fork参数可使其加入到后台守护进程组在后台运行<br>2.rpm包安装<br>MongoDB官网也提供了免费的yum源，通过配置yum源后可通过yum安装rpm包，yum源配置如下：<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/yum.repos.d/mongodb.repo    //编辑yum源配置文件，添加如下内容</span></span><br><span class="line"><span class="title">[mongodb]</span></span><br><span class="line"><span class="setting">name=<span class="value">MongoDB Repository</span></span></span><br><span class="line"><span class="setting">baseurl=<span class="value">http://downloads-distro.mongodb.org/repo/redhat/os/x<span class="number">86_64</span>/</span></span></span><br><span class="line"><span class="setting">enabled=<span class="value"><span class="number">1</span></span></span></span><br><span class="line"><span class="setting">gpgcheck=<span class="value"><span class="number">0</span></span></span></span><br></pre></td></tr></table></figure></p>
<p><strong>【注意】</strong> 如果你是32位操作系统，baseurl应该改成：<br><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baseurl=<span class="symbol">http:</span>/<span class="regexp">/downloads-distro.mongodb.org/repo</span><span class="regexp">/redhat/os</span><span class="regexp">/i686/</span></span><br></pre></td></tr></table></figure></p>
<p>配置好yum源，执行如下命令清空缓存并查看最新可用yum源配置情况：<br>    <figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># yum clean all</span></span><br><span class="line"><span class="preprocessor"># yum repolist</span></span><br></pre></td></tr></table></figure></p>
<p>确认yum源生效后可直接yum安装mongodb</p>
<pre><code><span class="preprocessor"># yum -y install mongodb-org</span>
</code></pre><p>启动mongod服务</p>
<pre><code><span class="preprocessor"># service mongod start</span>
</code></pre><h4 id="二、初次使用数据库">二、初次使用数据库</h4><h5 id="1-登录数据库">1.登录数据库</h5><p>  同样，如果没有修改环境变量的PATH，需要写出绝对路径执行mongodb的客户端命令mongo：</p>
<pre><code># <span class="regexp">/usr/</span>local<span class="regexp">/mongodb/</span>bin<span class="regexp">/mongo</span>
</code></pre><p>  否则，只需要在终端下执行mongo命令即可（包括yum方式安装也是如下登录方法）：</p>
<pre><code><span class="preprocessor"># mongo</span>
</code></pre><p>  类似于MySQL，初次使用，如果没有进行配置，默认以管理员身份登录，并且没有密码，并且此时默认登入到test库中。</p>
<h5 id="2-实际操作之前需要了解的一些有关MongoDB中数据库结构的知识">2.实际操作之前需要了解的一些有关MongoDB中数据库结构的知识</h5><ul>
<li>建库与建表：  <ul>
<li>在mongo中，没有复杂的建库建表的操作，我们先谈一下建表的操作，因为mongo本身是一种非关系型数据库，对各个字段没有多少限制，所以在mongo中，无需手动创建表，只要你在表中插入了一行数据，那这张表就自动创建了，后面将会介绍具体插入数据的操作；  </li>
<li>对于库（schema）也是这样的，只要你use了一个不存在的库，并且在这个库里面生成一张表，那这个库就自动创建了；  </li>
<li>当然，需要注意一点的是我们在mongo中把表叫做集合（collection），把记录（一行数据）叫做文档（documentation），本文为了方便理解，还将其叫做表和记录</li>
</ul>
</li>
<li>数据存储方式：<ul>
<li>在mongo的集合中，记录（一行数据）以BSON键值对（key:value）的方式进行存储，BSON是JSON（一种数据格式）格式的一种；</li>
<li>一行记录中可以有任意多个字段，这个字段的值可以是字符串、数字或者数组，数组也可以由多个键值对组成，类似于嵌套；</li>
<li>每两行记录之间没有必然的关系，比如说第一行可以有5个字段，并且它们的值全是数字，而第二行却可能是两个字段甚至字段对应的值的类型可以是字符串，和第一行没有任何关系</li>
</ul>
</li>
</ul>
<h5 id="3-数据库基本操作">3.数据库基本操作</h5><p>进入mongo shell界面（mongo shell默认的提示符为 &gt; ），首先当然是查看帮助了，直接在提示符后面输入help就可查看所有帮助目录了<br>如下命令查看所有你能看到的库<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="blockquote">&gt; show dbs</span></span><br></pre></td></tr></table></figure></p>
<p>直接输入db可查看你当前所在哪个库中<br>可通过show tables或者show collections命令查看当前库中的集合<br><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">show</span> <span class="built_in">tables</span></span><br><span class="line">&gt; <span class="built_in">show</span> collections</span><br></pre></td></tr></table></figure></p>
<p>以上两条命令执行结果完全一样，可根据喜好进行选择使用哪条命令，我个人比较喜欢后者，能看出和MySQL的区别并写貌似显得稍稍有点逼格（抱歉，吐槽段子，不喜勿喷啊！！！）<br><strong>【注意】</strong>mongo不像MySQL，在mongo shell中，所有的命令都无需添加分号结束，当然，加上分号也没有错。<br>除了上述操作之外，数据库基本操作无非就是增删改查</p>
<h6 id="增：给表中插入数据，简直太简单">增：给表中插入数据，简直太简单</h6><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="tag">use</span> <span class="tag">db1</span></span><br><span class="line">&gt; <span class="tag">db</span><span class="class">.c1</span><span class="class">.insert</span>(<span class="rules">&#123;<span class="rule"><span class="attribute">name</span>:<span class="value"><span class="string">"robin"</span>,age:<span class="number">21</span></span></span></span>&#125;)</span><br></pre></td></tr></table></figure>
<p>请看上述这两条命令，第一条命令进入到db1库中，第二条命令在c1表中插入一条记录，有两个字段分别是name和age，其值分别对应为”robin”和21，注意字符串要用引号引起来。<br>在一条记录中，多个字段之间用逗号分隔，字段与其对应的值用冒号隔开，{name:”robin”,age:21}就是一条BSON格式的数据<br><strong>【注意】</strong>在执行上述两条命令之前，db1库和c1表均不存在，当你执行了第一条命令并同时执行了第二条命令之后，会自动创建一个名叫db1的库并在该库下创建一个名叫c1的表，表中有一行你刚插入的数据。</p>
<h6 id="查：插入了数据，我们现在看一下怎么去查找数据，简直更简单">查：插入了数据，我们现在看一下怎么去查找数据，简直更简单</h6><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; use db1 进入db1库中</span><br><span class="line">&gt; db<span class="class">.c1</span><span class="class">.find</span>() <span class="comment">//查出了db1库下c1表中的所有数据</span></span><br></pre></td></tr></table></figure>
<p>有人说，通常情况下我不是需要所有数据，只需要查看满足某些特定条件的数据，请看如下命令：<br><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.c1.find(&#123;<span class="keyword">name</span>:<span class="string">"robin"</span>&#125;) //查看c1表中所有包含<span class="keyword">name</span>字段（注意有些记录可能不包含<span class="keyword">name</span>字段哦…）并且对应的值是robin的记录</span><br></pre></td></tr></table></figure></p>
<p>看到上一条命令查询结果你会发现，每一条记录都多出来一个”_id”的属性并且每行记录的_id属性对应的值是唯一的，这是mongo在你插入数据的时候自动添加的，用来进行索引加快查询速度<br>如果我不想看到_id字段，可参考如下命令：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.c1.find(&#123;<span class="string">name:</span><span class="string">"robin"</span>&#125;,&#123;<span class="string">_id:</span><span class="number">0</span>&#125;) <span class="comment">//后面的0表示不显示_id属性，如果将其设置为1，则显示_id属性，默认为1</span></span><br></pre></td></tr></table></figure></p>
<p>当然，如果我只想看到名字叫做robin的这个人的age，而不想看到他的_id和name，那么可参考如下命令：<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; db.c1.find(&#123;<span class="string">name:</span><span class="string">"robin"</span>&#125;,&#123;<span class="string">_id:</span><span class="number">0</span>,<span class="string">age:</span><span class="number">1</span>&#125;) <span class="comment">//这条命令结果只会显示age这个字段和它对应的值，如果_id:0后面什么都没有，则默认显示除了_id字段之外的所有字段，如果_id后面写了其它字段并且格式为field：1，则只显示后面添加的字段。【注意：这里的field:1中的数字1改成0的话会显示语法错误，只有_id字段可以使用0】</span></span><br></pre></td></tr></table></figure></p>
<p>查找小结：查找主要使用find方法，格式db.表名.find({},{})，第一个{}里写的是过滤记录的条件，第二个{}写的是需要显示的字段</p>
<h6 id="删：删除记录的操作和查找有点类似">删：删除记录的操作和查找有点类似</h6><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="tag">use</span> <span class="tag">db1</span></span><br><span class="line">&gt; <span class="tag">db</span><span class="class">.c1</span><span class="class">.remove</span>(<span class="rules">&#123;&#125;</span>) 删除<span class="tag">c1</span>表中所有记录</span><br><span class="line">&gt; <span class="tag">db</span><span class="class">.c1</span><span class="class">.remove</span>(<span class="rules">&#123;<span class="rule"><span class="attribute">name</span>:<span class="value"><span class="string">"robin"</span></span></span></span>&#125;) 删除<span class="tag">c1</span>表中所有包含<span class="tag">name</span>字段并且对应值为<span class="tag">robin</span>的记录</span><br><span class="line">&gt; <span class="tag">db</span><span class="class">.c1</span><span class="class">.remove</span>(<span class="rules">&#123;<span class="rule"><span class="attribute">name</span>:<span class="value"><span class="string">"robin"</span></span></span></span>&#125;,1) 删除<span class="tag">c1</span>表中匹配到的第一条包含        <span class="tag">name</span>字段并且值为<span class="tag">robin</span>的记录</span><br></pre></td></tr></table></figure>
<h6 id="改：">改：</h6><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; use db1</span><br><span class="line">&gt; db.c1.<span class="keyword">update</span>(&#123;name:<span class="string">"robin"</span>&#125;,&#123;<span class="variable">$set</span>:&#123;age:<span class="number">100</span>&#125;&#125;) //将第一个匹配到的名叫robin的人的age改成<span class="number">100</span></span><br><span class="line">&gt; db.c1.<span class="keyword">update</span>(&#123;name:<span class="string">"robin"</span>&#125;,&#123;<span class="variable">$set</span>:&#123;age:<span class="number">100</span>&#125;&#125;,&#123;multi:true&#125;) //将所有匹配到的名叫robin的人的age改成<span class="number">100</span></span><br><span class="line">&gt; db.c1.<span class="keyword">update</span>(&#123;name:<span class="string">"robin"</span>&#125;,&#123;name:<span class="string">"kitty"</span>, birthday:<span class="string">"0316"</span>&#125;) //仔细将这条命令和第一条修改命令进行比较，发现它没有set，所以这是一条替换命令，将匹配到的记录的字段全都删除（_id字段除外），然后添加两个字段分别是name和birthday，对应值分别是<span class="string">"kitty"</span>和<span class="string">"0316"</span>。</span><br></pre></td></tr></table></figure>
<h4 id="三、停止mongodb服务">三、停止mongodb服务</h4><p>有的朋友说，这好办，直接kill掉mongod的进程不得了，确实说的没错，我们可以先通过”ps aux| grep mongod”命令查看mongod的进程号，然后kill掉，虽然可以达到目的，但是明显这么做不太合理。<br>正常情况下如果我想关闭mysqld服务，直接执行命令”service mysqld stop”就可以了，当然，如果你是yum安装的话，通过”service mongod start”命令启动的话自然可以通过这种方式停止服务，但是如果你是解压缩安装的MongoDB，那就不可以了，系统会告诉你mongod是个无法识别的服务，这个时候正常的关闭就显得有点奇葩了，你需要以管理员身份登录到mongo shell中，进入到admin库中关闭服务，命令如下：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="blockquote">&gt; use admin</span></span><br><span class="line"><span class="blockquote">&gt; db.shutdownServer()</span></span><br><span class="line"><span class="blockquote">&gt; exit</span></span><br></pre></td></tr></table></figure></p>
<h4 id="四、MongoDB用户权限管理">四、MongoDB用户权限管理</h4><p>1.启动mongod数据库服务（详请参考上文）<br>2.以管理员身份登录mongo shell（详请参考上文）<br>3.进入到admin库中添加一个管理员帐户，命令如下：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; use admin</span><br><span class="line">&gt; db.<span class="function"><span class="title">addUser</span><span class="params">(&#123;<span class="string">"root"</span>:<span class="string">"123"</span>&#125;)</span></span> <span class="comment">//添加一个管理员帐号，用户名为root，密码为123</span></span><br></pre></td></tr></table></figure></p>
<p>4.添加一个普通账户，命令如下：<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; use db1</span><br><span class="line">&gt; db.<span class="function"><span class="title">addUser</span><span class="params">(&#123;<span class="string">"alice"</span>:<span class="string">"456"</span>&#125;)</span></span> <span class="comment">//为db1库添加一个用户，用户名为alice，密码为456</span></span><br></pre></td></tr></table></figure></p>
<p><strong>【注意】</strong> 除了在admin库中创建的用户是管理员用户以外，在其它任意库中创建的用户都是普通用户，只能看到他所属的库里的数据<br>5.关闭mongod服务（详请参考上文）<br>6.启动带身份验证的mongod服务<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># mongod —dbpath=/data/db —auth —fork</span></span><br></pre></td></tr></table></figure></p>
<p>7.此时再次输入mongo则无法进入mongo shell，需要通过如下命令进行身份验证方可进入，此时有点类似于mysql<br><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor"># mongo -uroot -p123 以root身份登录数据库</span></span><br></pre></td></tr></table></figure></p>
<h4 id="总结：">总结：</h4><p>对于初学者来说，我觉得理解MongoDB最重要的一点就是在于对BSON这种数据格式（一对{}里面存放键值对，多个键值对用逗号隔开）的理解，以及要重点注意在MongoDB中同一张表中的不同记录之间是没有必然的联系的，因此你可以随心所欲的存放任何你想要存储的数据，对于有MySQL或其它关系型数据库经验的初学者来说，其复杂度看似提高却又有种化繁为简的感觉。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2015/01/05/记一次shell变量赋值时踩得坑/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          记一次shell变量赋值时踩得坑
        
      </div>
    </a>
  
  
</nav>

  
</article>


<div class="share">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到：</span>
		<a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
		<a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>



<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="分分钟入门mongodb" data-title="分分钟入门mongodb" data-url="http://huxiaobo.net/2014/09/20/分分钟入门mongodb/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Robin_Hu
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>